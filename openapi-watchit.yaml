openapi: 3.0.0
info:
  title: WatchIt API
  version: 1.0.0
  description: This is the WatchIt API
  contact:
    name: Maxime Biechy
    email: biechymaxime@gmail.com
servers:
  - url: http://localhost:3000
    description: Development server (uses docker-compose.dev.yml)
paths:
  /api-docs:
    get:
      summary: Get the OpenAPI documentation
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  openapi:
                    type: string
                    example: 3.0.0
                  info:
                    type: object
                    properties:
                      title:
                        type: string
                        example: WatchIt API
                      version:
                        type: string
                        example: 1.0.0
                      description:
                        type: string
                        example: This is the WatchIt API
                      contact:
                        type: object
                        properties:
                          name:
                            type: string
                            example: Maxime Biechy
                          email:
                            type: string
                            example: biechymaxime@gmail.com
  /debug-sentry:
    get:
      summary: Test Sentry error handling
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Sentry is working
  /api/v1:
    get:
      summary: Check if the API is working
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: API is working
  /api/v1/users:
    get:
      summary: Get all users
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: success
                  users:
                    type: array
                    items:
                      type: object
                      properties:
                        username:
                          type: string
                          example: john_doe
                        email:
                          type: string
                          example: john.doe@example.com
                        createdAt:
                          type: string
                          format: date-time
                          example: 2025-02-01T16:37:48.343Z
                        updatedAt:
                          type: string
                          format: date-time
                          example: 2025-02-01T16:37:48.343Z
                  message:
                    type: string
                    example: Users fetched successfully
        '500':
          $ref: '#/components/responses/DatabaseError'
  /api/v1/auth/register:
    post:
      summary: Create a new user
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                username:
                  type: string
                  example: Maxime
                email:
                  type: string
                  example: biechymaxime@gmail.com
                password:
                  type: string
                  example: mypassword
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: success
                  user:
                    type: object
                    properties:
                      id:
                        type: string
                        example: 34843a90-2ee8-463f-8b41-0153e97bdbee
                      username:
                        type: string
                        example: Maxime
                      email:
                        type: string
                        example: biechymaxime@gmail.com
                      createdAt:
                        type: string
                        format: date-time
                        example: 2025-01-01T00:00:00.000Z
                      updatedAt:
                        type: string
                        format: date-time
                        example: 2025-01-01T00:00:00.000Z
                  message:
                    type: string
                    example: User created successfully
        '400':
          $ref: '#/components/responses/ValidationError'
        '500':
          $ref: '#/components/responses/DatabaseError'

components:
  responses:
    ValidationError:
      description: Validation error
      content:
        application/json:
          schema:
            type: object
            properties:
              message:
                type: string
                example: Missing required fields
              code:
                type: string
                example: ValidationError
    DatabaseError:
      description: Database error
      content:
        application/json:
          schema:
            type: object
            properties:
              message:
                type: string
                example: Database error occurred
              code:
                type: string
                example: DatabaseError
    NotFoundError:
      description: Resource not found
      content:
        application/json:
          schema:
            type: object
            properties:
              message:
                type: string
                example: Resource not found
              code:
                type: string
                example: NotFoundError
    InternalServerError:
      description: Internal server error
      content:
        application/json:
          schema:
            type: object
            properties:
              message:
                type: string
                example: Internal Server Error
              code:
                type: string
                example: InternalServerError
